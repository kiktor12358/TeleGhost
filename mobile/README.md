# üì± TeleGhost Mobile ‚Äî –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

## ‚úÖ –ß—Ç–æ –£–ñ–ï —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–æ–∑–¥–∞–Ω–∞**
- ‚úÖ `frontend/src/lib/api_bridge.js` ‚Äî JS Bridge (Desktop ‚Üî Mobile)
- ‚úÖ `mobile/mobile.go` ‚Äî Go HTTP-—Å–µ—Ä–≤–µ—Ä (–∫–∞—Ä–∫–∞—Å –≥–æ—Ç–æ–≤)
- ‚úÖ `android/` ‚Äî Kotlin –ø—Ä–æ–µ–∫—Ç (MainActivity + TeleGhostService)
- ‚úÖ `.github/workflows/android.yml` ‚Äî CI/CD pipeline —Å CGO + NDK

### 2. **–ß—Ç–æ —Å–æ–±–µ—Ä—ë—Ç—Å—è —á–µ—Ä–µ–∑ CI**
- ‚úÖ `teleghost.aar` ‚Äî gomobile bind —Å CGO_ENABLED=1
- ‚úÖ Android APK —Å WebView
- ‚ö†Ô∏è **–ù–û**: `mobile.go` —Å–æ–¥–µ—Ä–∂–∏—Ç **–ø—Ä–æ—Ç–æ—Ç–∏–ø-–∑–∞–≥–ª—É—à–∫–∏**

---

## ‚ö†Ô∏è –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏

### **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –≤ `mobile.go`:**

#### 1. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π** (—Å—Ç—Ä–æ–∫–∞ 741-804)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ß–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `core.Message`, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—ã  
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
```go
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ repo.SaveMessage() –ø—Ä–∏–Ω–∏–º–∞–µ—Ç *core.Message
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ messenger.SendTextMessage() —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

#### 2. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤** (—Å—Ç—Ä–æ–∫–∞ 726-732)
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ó–∞–≥–ª—É—à–∫–∞  
**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```go
func (app *MobileApp) addContact(name, destination string) (interface{}, error) {
    return nil, fmt.Errorf("AddContact: implement via internal packages")
}
```

**–ù—É–∂–Ω–æ:**
```go
func (app *MobileApp) addContact(name, destination string) (*core.Contact, error) {
    // 1. –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç –≤ –ë–î
    contact := &core.Contact{
        ID:         uuid.New().String(),
        Nickname:   name,
        I2PAddress: destination,
        AddedAt:    time.Now(),
        UpdatedAt:  time.Now(),
    }
    
    // 2. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
    if err := app.repo.SaveContact(app.ctx, contact); err != nil {
        return nil, err
    }
    
    // 3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å handshake
    if app.messenger != nil {
        go app.messenger.SendHandshake(destination)
    }
    
    // 4. Emit —Å–æ–±—ã—Ç–∏–µ
    app.emitEvent("new_contact", map[string]interface{}{
        "nickname": name,
    })
    
    return contact, nil
}
```

#### 3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π** (—Å—Ç—Ä–æ–∫–∞ 642-653)
**–°—Ç–∞—Ç—É—Å:** ‚ùå –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ë–î, –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –∫–æ–Ω—Ç–∞–∫—Ç—ã  

**–ù—É–∂–Ω–æ:** –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –∏–∑ `app_messages.go:onMessageReceived()` (—Å—Ç—Ä–æ–∫–∏ 233-289)

#### 4. **–ü—Ä–æ—Ñ–∏–ª–∏ –∏ Identity** (—Å—Ç—Ä–æ–∫–∏ 509-569)
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã  
**–ü—Ä–æ–±–ª–µ–º–∞:**
- `identity.FromMnemonic()` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- `identity.Generate()` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç  
- `profileManager.CreateProfile()` –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ `app_auth.go` –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É

---

## üîß –ü–ª–∞–Ω –¥–æ—Ä–∞–±–æ—Ç–∫–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: **–ë—ã—Å—Ç—Ä—ã–π (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π MVP)**
–û—Å—Ç–∞–≤–∏—Ç—å `mobile.go` –∫–∞–∫ –µ—Å—Ç—å, –Ω–æ **–∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å** —á—Ç–æ —ç—Ç–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø.  
**–ü–ª—é—Å—ã:**
- CI —Å–æ–±–µ—Ä—ë—Ç .aar –∏ APK
- –ú–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å UI –Ω–∞ Android
- –ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ú–∏–Ω—É—Å—ã:**
- –°–æ–æ–±—â–µ–Ω–∏—è –ù–ï –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- –ö–æ–Ω—Ç–∞–∫—Ç—ã –ù–ï –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è
- –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### –í–∞—Ä–∏–∞–Ω—Ç 2: **–ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è** ‚≠ê (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
–ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ –∑–∞–≥–ª—É—à–∫–∏ –≤ `mobile.go`:

1. **–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –∏–∑ `app_*.go`**
   - `addContact()` ‚Üí –∏–∑ `app_contacts.go:AddContact()`
   - `sendText()` ‚Üí –∏–∑ `app_messages.go:SendText()` ‚úÖ (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)
   - `onMessageReceived()` ‚Üí –∏–∑ `app_messages.go:onMessageReceived()`
   - `createProfile()`, `login()` ‚Üí –∏–∑ `app_auth.go`

2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –∏ —Ç–∏–ø—ã**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `core.Message`, `core.Contact`, `core.User`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ `repo.*` –∏ `messenger.*`

3. **–î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –º–µ—Ç–æ–¥—ã**
   - `SendFileMessage()` –¥–ª—è Android
   - `AcceptFileTransfer()`, `DeclineFileTransfer()`
   - `UpdateProfile()`, `RequestProfileUpdate()`

---

## üöÄ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –°–ï–ô–ß–ê–°

### Desktop (—Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é)
```bash
wails dev
```

### Android (—Ç–æ–ª—å–∫–æ UI, –±–µ–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏)
1. –ó–∞–ø—É—à–∏—Ç—å –≤ GitHub
2. –°–æ–∑–¥–∞—Ç—å —Ç–µ–≥: `git tag v1.0.3-android && git push --tags`
3. –°–∫–∞—á–∞—Ç—å `.apk` –∏–∑ GitHub Release
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ Android
5. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ WebView –æ—Ç–∫—Ä–æ–µ—Ç—Å—è
   - ‚úÖ UI –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è
   - ‚ùå –õ–æ–≥–∏–Ω –ù–ï —Å—Ä–∞–±–æ—Ç–∞–µ—Ç (–∑–∞–≥–ª—É—à–∫–∏ –≤ mobile.go)
   - ‚ùå –°–æ–æ–±—â–µ–Ω–∏—è –ù–ï –æ—Ç–ø—Ä–∞–≤—è—Ç—Å—è

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
1. **–î–æ–¥–µ–ª–∞—Ç—å `mobile.go`** ‚Äî —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å—é –ª–æ–≥–∏–∫—É –∏–∑ `app_*.go`
2. **–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã** ‚Äî unit-—Ç–µ—Å—Ç—ã –¥–ª—è HTTP API
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** ‚Äî —É–ª—É—á—à–∏—Ç—å error handling –≤ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–µ
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –¥–æ–±–∞–≤–∏—Ç—å structured logging (logrus/zap)
5. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚Äî –¥–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è HTTP API

### –î–ª—è MVP (–±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç):
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ **–∫—Ä–∏—Ç–∏—á–Ω—ã–µ** –º–µ—Ç–æ–¥—ã:
   - `sendText()` ‚úÖ
   - `addContact()` ‚ùå
   - `onMessageReceived()` ‚ùå
2. –û—Å—Ç–∞–ª—å–Ω–æ–µ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–π flow: Login ‚Üí Add Contact ‚Üí Send Message

---

## üéØ –ò—Ç–æ–≥

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞, –Ω–æ `mobile.go` ‚Äî —ç—Ç–æ **–ø—Ä–æ—Ç–æ—Ç–∏–ø —Å –∑–∞–≥–ª—É—à–∫–∞–º–∏**.

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ CI/CD pipeline (—Å–±–æ—Ä–∫–∞ .aar + APK)
- ‚úÖ Android –ø—Ä–æ–µ–∫—Ç (Service + WebView)
- ‚úÖ JS Bridge (api_bridge.js)
- ‚úÖ HTTP —Å–µ—Ä–≤–µ—Ä (—Ä–æ—É—Ç–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤)
- ‚úÖ SSE —Å–æ–±—ã—Ç–∏—è (real-time)

**–ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚ùå –õ–æ–≥–∏–Ω/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã)
- ‚ùå –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ (–∑–∞–≥–ª—É—à–∫–∞)
- ‚ùå –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
- ‚ùå –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤ (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –í—ã–±—Ä–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç 1 (MVP) –∏–ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç 2 (–ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è) –∏ –¥–æ–¥–µ–ª–∞—Ç—å `mobile.go`.
